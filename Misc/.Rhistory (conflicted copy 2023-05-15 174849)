mu <- a_by[birthy] + b[birthy]*meanw,
a_by[birthy] ~ normal(20,5),
b[birthy] ~ dnorm(b_bar,b_sigma),
b_bar ~ normal(0,1),
b_sigma ~ exponential(1),
sigma ~ exponential(1)
) , data=data_list , chains=4 , cores=4
)
datp_m <- list(
birthy=rep(1:27,each=9),meanw=rep(seq(-1,1,length=9),27)  )
p_post_m<- link( mgaus11_a , data=datp_s )
p_mu_m <- apply( p_post_s , 2 , mean )
p_ci_m <- apply( p_post_s , 2 , PI )
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction"   )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
datp_m <- list(
birthy=rep(1:27,each=9),meanw=rep(seq(-1,1,length=9),27)  )
p_post_m<- link( mgaus11_a , data=datp_s )
datp_m <- list(
birthy=rep(1:27,each=9),meanw=rep(seq(-1,1,length=9),27)  )
p_post_m<- link( mgaus11_a , data=datp_m )
p_mu_m <- apply( p_post_m , 2 , mean )
p_ci_m <- apply( p_post_m , 2 , PI )
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction"   )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = c(1, 81),
labels = c("Some text", "Other text"))
axis(1, at = c(1, 81),
labels = 1969:1998)
length(c(1,81))
axis(1, at = 1:81,
labels = 1969:1998)
axis(1, at = 1,
labels = 1969)
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction"   )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = 1,
labels = 1969)
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = c(1, 81),
labels = c("Some text", "Other text"))
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = c(1, 81),
labels = c(1969, 1998))
seq(1:81,by=5)
seq(1,81,by=5)
axis(1, at = seq(1,81,by=5),
labels = c(1969))
axis(1, at = seq(1,81,by=5),
labels = rep(1969,17))
axis(1, at = seq(1,81,by=5),
labels = c(1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984))
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(1,81,by=5),
labels = c(1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985))
mtext(seq(1970,1996,length=30),side=1,at=41)
mtext("birth year",side=1,at=40,line=1)
seq(1,81,by=5)
axis(1, at = seq(1,81,by=5),
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(1,81,by=5),
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(1,81,by=5),
labels = c(1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985))
axis(1, at = seq(1,81,by=5),
labels = 1969:1998)
c(1969Â¨1998)[1]
c(1969:1998)[1]
c(1969:1998)[6]
seq(1,81,by=5)
axis(1, at = seq(1,81,by=5),
axis(1, at = seq(1,81,by=5),
labels = c(c(1969:1998)[1],c(1969:1998)[6],c(1969:1998)[11],c(1969:1998)[16],c(1969:1998)[21],c(1969:1998)[26],c(1969:1998)[31],c(1969:1998)[36],c(1969:1998)[41],c(1969:1998)[46],c(1969:1998)[51],c(1969:1998)[56],c(1969:1998)[61],c(1969:1998)[66],c(1969:1998)[71],c(1969:1998)[76],c(1969:1998)[81]))
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(1,81,by=5),
labels = c(c(1969:1998)[1],c(1969:1998)[6],c(1969:1998)[11],c(1969:1998)[16],c(1969:1998)[21],c(1969:1998)[26],c(1969:1998)[31],c(1969:1998)[36],c(1969:1998)[41],c(1969:1998)[46],c(1969:1998)[51],c(1969:1998)[56],c(1969:1998)[61],c(1969:1998)[66],c(1969:1998)[71],c(1969:1998)[76],c(1969:1998)[81]))
c(c(1969:1998)[1],c(1969:1998)[6],c(1969:1998)[11],c(1969:1998)[16],c(1969:1998)[21],c(1969:1998)[26],c(1969:1998)[31],c(1969:1998)[36],c(1969:1998)[41],c(1969:1998)[46],c(1969:1998)[51],c(1969:1998)[56],c(1969:1998)[61],c(1969:1998)[66],c(1969:1998)[71],c(1969:1998)[76],c(1969:1998)[81])
axis(1, at = seq(1,81,by=5),
labels = c(1969,1970,1974,1977,1979,192,1984,1987,1989,1992,1994,1996,1998))
axis(1, at = seq(1,81,by=5),
labels = c(1969,1969,1974,1969,1979,1969,1984,1969,1989,1969,1994,1969,1998))
1998-1969
axis(1, at = seq(1,81,by=5),
labels = c(1969," ",1972," ",1975," ",1978," ",1981," ",1984," ",1987," ",1990," ",1993," ",1996))
axis(1, at = seq(1,81,by=5),
labels = c(1969," ",1973," ",1977," ",1981," ",1985," ",1989," ",1993," ",1997))
axis(1, at = seq(1,81,by=5),
labels = c(1969," ",1972," ",1975," ",1978," ",1981," ",1984," ",1987," ",1990," ",1993," ",1996))
axis(1, at = seq(1,81,by=5),
labels = c(1969," ",1972," ",1975," ",1978," ",1981," ",1984," ",1987," ",1990," ",1998))
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(1,81,by=5),
labels = c(1969," ",1972," ",1975," ",1978," ",1981," ",1984," ",1987," ",1990," ",1998))
axis(1, at = seq(1,81,by=4),
labels = c(1969," ",1973," ",1977," ",1981," ",1985," ",1989," ",1993," ",1997))
axis(1, at = seq(1,81,by=5),
labels = c(1969," ",1973," ",1977," ",1981," ",1985," ",1989," ",1993," ",1997))
axis(1, at = seq(1,81,by=6),
labels = c(1969," ",1973," ",1977," ",1981," ",1985," ",1989," ",1993," ",1997))
axis(1, at = seq(0,81,by=6),
labels = c(1969," ",1973," ",1977," ",1981," ",1985," ",1989," ",1993," ",1997))
19998-1969
1998-1969
1998-1970
axis(1, at = seq(0,81,by=5),
labels = c(1970," ",1974," ",1978," ",1982," ",1986," ",1990," ",1994," ",1998))
axis(1, at = seq(0,81,by=5),
labels = c(1970," ",1973," ",1976," ",1979," ",1982," ",1985," ",1988," ",1991," ",1994," ",1997))
axis(1, at = seq(0,81,by=4),
labels = c(1970," ",1973," ",1976," ",1979," ",1982," ",1985," ",1988," ",1991," ",1994," ",1997))
axis(1, at = seq(0,81,by=6),
labels = c(1970," ",1974," ",1978," ",1982," ",1986," ",1990," ",1994," ",1998))
axis(1, at = seq(0,81,by=6),
labels = c(" ",1970," ",1974," ",1978," ",1982," ",1986," ",1990," ",1994," ",1998))
seq(1970,1996,length=17)
round(seq(1970,1996,length=17))
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)))
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)))
mtext("birth year",side=1,at=40,line=1)
mtext("birth year",side=1,at=40,line=0)
mtext("birth year",side=1,at=40,line=3)
mtext("birth year",side=1,at=40,line=2)
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)))
mtext(seq(1970,1996,length=30),side=1,at=41)
mtext("birth year",side=1,at=40,line=2)
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)))
mtext("birth year",side=1,at=40,line=2)
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)))
mtext("Birth year",side=1,at=40,line=2)
mtext("Birth year",side=1,at=40,line=2.5)
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)))
mtext("Birth year",side=1,at=40,line=2.5)
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab="Standardized average wealth" ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)))
mtext("Birth year",side=1,at=40,line=2.3)
datp_s <- list(
birthy=rep(14,each=9),meanw=rep(seq(-1,1,length=9))  )
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n"  )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)))
mtext("Birth year",side=1,at=40,line=3)
mtext("Standard average wealth",side=1,at=40,line=4)
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex=1.5 )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)))
mtext("Birth year",side=1,at=40,line=3,cex=1.5)
mtext("Standard average wealth",side=1,at=40,line=4,cex=1.5)
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.axis=1.5 )
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5 )
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5 )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)))
mtext("Birth year",side=1,at=40,line=3,cex=1.5)
mtext("Standard average wealth",side=1,at=40,line=4,cex=1.5)
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)),cex=1.5)
mtext("Birth year",side=1,at=40,line=3,cex=1.5)
mtext("Standard average wealth",side=1,at=40,line=4,cex=1.5)
?axis
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)),cex.axis=1.5)
mtext("Birth year",side=1,at=40,line=3,cex=1.5)
mtext("Standard average wealth",side=1,at=40,line=4,cex=1.5)
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_a[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
datp_a <- list(
birthy=rep(1:27,each=9),absw=rep(seq(-1,1,length=9),27)  )
p_post_a <- link( mgaus12_a , data=datp_a )
#model with absolute wealth
mgaus12_a <- ulam(
alist(
AFR ~ normal( mu , sigma ),
mu <- a_by[birthy] + c[birthy]*absw,
a_by[birthy] ~ normal(20,5),
c[birthy] ~ dnorm(c_bar,c_sigma),
c_bar ~ normal(0,1),
c_sigma ~ exponential(1),
sigma ~ exponential(1)
) , data=data_list , chains=4 , cores=4
)
datp_a <- list(
birthy=rep(1:27,each=9),absw=rep(seq(-1,1,length=9),27)  )
p_post_a <- link( mgaus12_a , data=datp_a )
p_mu_a <- apply( p_post_a , 2 , mean )
p_ci_a <- apply( p_post_a , 2 , PI )
plot( NULL , xlim=c(1,81) , ylim=c(15,30) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_a[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
plot( NULL , xlim=c(1,81) , ylim=c(15,35) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_a[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
plot( NULL , xlim=c(1,81) , ylim=c(15,32) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_a[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
plot( NULL , xlim=c(1,81) , ylim=c(15,32) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_a[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)),cex.axis=1.5)
mtext("Birth year",side=1,at=40,line=3,cex=1.5)
mtext("Standard absolute wealth",side=1,at=40,line=4,cex=1.5)
plot( NULL , xlim=c(1,81) , ylim=c(15,32) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_m[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)),cex.axis=1.5)
mtext("Birth year",side=1,at=40,line=3,cex=1.5)
mtext("Standard average wealth",side=1,at=40,line=4,cex=1.5)
plot( NULL , xlim=c(1,81) , ylim=c(15,32) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_a[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)),cex.axis=1.5)
mtext("Birth year",side=1,at=40,line=3,cex=1.5)
mtext("Standard absolute wealth",side=1,at=40,line=4,cex=1.5)
mgaus13_a <- ulam(
alist(
AFR ~ normal( mu , sigma ),
mu <- a_by[birthy] + d[birthy]*sdw,
a_by[birthy] ~ normal(20,5),
d[birthy] ~ dnorm(d_bar,d_sigma),
d_bar ~ normal(0,1),
d_sigma ~ exponential(1),
sigma ~ exponential(1)
) , data=data_list , chains=4 , cores=4
)
datp_s <- list(
birthy=rep(1:27,each=9),absw=rep(seq(-1,1,length=9),27)  )
p_post_s <- link( mgaus13_a , data=datp_s )
p_mu_s <- apply( p_post_s , 2 , mean )
p_ci_s <- apply( p_post_s , 2 , PI )
plot( NULL , xlim=c(1,81) , ylim=c(15,32) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_a[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
plot( NULL , xlim=c(1,81) , ylim=c(15,32) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_s[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
datp_s <- list(
birthy=rep(1:27,each=9),absw=rep(seq(-1,1,length=9),27)  )
datp_s <- list(
birthy=rep(1:27,each=9),absw=rep(seq(-1,1,length=9),27)  )
p_post_s <- link( mgaus13_a , data=datp_s )
datp_s <- list(
birthy=rep(1:27,each=9),sdw=rep(seq(-1,1,length=9),27)  )
p_post_s <- link( mgaus13_a , data=datp_s )
p_mu_s <- apply( p_post_s , 2 , mean )
p_ci_s <- apply( p_post_s , 2 , PI )
plot( NULL , xlim=c(1,81) , ylim=c(15,32) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_s[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
datp_s <- list(
birthy=rep(1:27,each=9),sdw=rep(seq(-1,1,length=9),27)  )
p_post_s <- link( mgaus13_a , data=datp_s )
p_mu_s <- apply( p_post_s , 2 , mean )
p_ci_s <- apply( p_post_s , 2 , PI )
plot( NULL , xlim=c(1,81) , ylim=c(15,32) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_s[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
d_bar
datp_s
p_post_s
p_mu_s
#check the model
precis(mgaus13_a,depth=1)
datp_s <- list(
birthy=rep(1:27,each=9),sdw=rep(seq(-1,1,length=9),27)  )
p_post_s <- link( mgaus13_a , data=datp_s )
p_mu_s <- apply( p_post_s , 2 , mean )
p_ci_s <- apply( p_post_s , 2 , PI )
plot( NULL , xlim=c(1,81) , ylim=c(15,32) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_s[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)),cex.axis=1.5)
mtext("Birth year",side=1,at=40,line=3,cex=1.5)
mtext("Standard SD wealth",side=1,at=40,line=4,cex=1.5)
mtext("Standard wealth SD",side=1,at=40,line=4,cex=1.5)
plot( NULL , xlim=c(1,81) , ylim=c(15,32) , xlab=" " ,
ylab="Age at first reproduction" , xaxt="n" ,cex.lab=1.5, cex.axis=1.5 )
for(i in 2:27){
lines(p_mu_s[ ((i-1)*9-8):((i-1)*9) ]~seq(i*3-2,i*3,length=9))
}
axis(1, at = seq(0,81,by=5),
labels = round(seq(1969,1998,length=17)),cex.axis=1.5)
mtext("Birth year",side=1,at=40,line=3,cex=1.5)
mtext("Standard wealth SD",side=1,at=40,line=4,cex=1.5)
sd(c(rep(1,10),rep(0,90)))
sd(c(rep(1,20),rep(0,80)))
sd(c(rep(1,90),rep(0,10)))
sd(c(rep(1,50),rep(0,50)))
rep(1,50)
sd(c(rep(1,1),rep(0,99)))
c(rep(1,10),rep(0,90))
mean(c(rep(1,10),rep(0,90)))
sd(c(rep(1,10),rep(0,90)))
mean(c(rep(1,50),rep(0,50)))
sd(c(rep(1,50),rep(0,50)))
mean(c(rep(1,90),rep(0,10)))
sd(c(rep(1,90),rep(0,10)))
#install package to import excel file
#install.packages("readxl")
library(readxl)
### Import data ----
#import data
#demographic data
data_demo <- read_excel("C:/Users/pablo_varas/Nextcloud/PhD/Chapter 3/data/pablo_demog_ui_dec 23 2022.xlsx",sheet = "cases with AFB & UI sent")
#wealth data
data_wealth <- read_excel("C:/Users/pablo_varas/Nextcloud/PhD/Chapter 3/data/hsh wealth for pablo_dec 23 2022.xls", sheet = "hshold data (n=1695)")
### Merge data ----
#subset wealth data by year
#1995
data_wealth_95 <- data_wealth[which(data_wealth$UIyearXhsh > 1995000 & data_wealth$UIyearXhsh < 1996000),]
#1998
data_wealth_98 <- data_wealth[which(data_wealth$UIyearXhsh > 1998000 & data_wealth$UIyearXhsh < 1999000),]
#2000
data_wealth_00 <- data_wealth[which(data_wealth$UIyearXhsh > 2000000 & data_wealth$UIyearXhsh < 2001000),]
#2002
data_wealth_02 <- data_wealth[which(data_wealth$UIyearXhsh > 2002000 & data_wealth$UIyearXhsh < 2003000),]
#2004
data_wealth_04 <- data_wealth[which(data_wealth$UIyearXhsh > 2004000 & data_wealth$UIyearXhsh < 2005000),]
#2006
data_wealth_06 <- data_wealth[which(data_wealth$UIyearXhsh > 2006000 & data_wealth$UIyearXhsh < 2007000),]
#2010
data_wealth_10 <- data_wealth[which(data_wealth$UIyearXhsh > 2010000 & data_wealth$UIyearXhsh < 2011000),]
#change UIyearXhsh name by year
#1995
names(data_wealth_95)[names(data_wealth_95) == "UIyearXhsh"] <- "UIyearXhsh95"
colnames(data_wealth_95) <- c("UIyearXhsh95","acused95","ttsacks95","jjunezero95","LstockValField_rdKts95","HsVal_rdKts95","HsTotAsset_rdKts95","SumValue_rdKts95","IWC95","Loiske_rev95")
#1998
names(data_wealth_98)[names(data_wealth_98) == "UIyearXhsh"] <- "UIyearXhsh98"
colnames(data_wealth_98) <- c("UIyearXhsh98","acused98","ttsacks98","jjunezero98","LstockValField_rdKts98","HsVal_rdKts98","HsTotAsset_rdKts98","SumValue_rdKts98","IWC98","Loiske_rev98")
#2000
names(data_wealth_00)[names(data_wealth_00) == "UIyearXhsh"] <- "UIyearXhsh00"
colnames(data_wealth_00) <- c("UIyearXhsh00","acused00","ttsacks00","jjunezero00","LstockValField_rdKts00","HsVal_rdKts00","HsTotAsset_rdKts00","SumValue_rdKts00","IWC00","Loiske_rev00")
#2002
names(data_wealth_02)[names(data_wealth_02) == "UIyearXhsh"] <- "UIyearXhsh02"
colnames(data_wealth_02) <- c("UIyearXhsh02","acused02","ttsacks02","jjunezero02","LstockValField_rdKts02","HsVal_rdKts02","HsTotAsset_rdKts02","SumValue_rdKts02","IWC02","Loiske_rev02")
#2004
names(data_wealth_04)[names(data_wealth_04) == "UIyearXhsh"] <- "UIyearXhsh04"
colnames(data_wealth_04) <- c("UIyearXhsh04","acused04","ttsacks04","jjunezero04","LstockValField_rdKts04","HsVal_rdKts04","HsTotAsset_rdKts04","SumValue_rdKts04","IWC04","Loiske_rev04")
#2006
names(data_wealth_06)[names(data_wealth_06) == "UIyearXhsh"] <- "UIyearXhsh06"
colnames(data_wealth_06) <- c("UIyearXhsh06","acused06","ttsacks06","jjunezero06","LstockValField_rdKts06","HsVal_rdKts06","HsTotAsset_rdKts06","SumValue_rdKts06","IWC06","Loiske_rev06")
#2010
names(data_wealth_10)[names(data_wealth_10) == "UIyearXhsh"] <- "UIyearXhsh10"
colnames(data_wealth_10) <- c("UIyearXhsh10","acused10","ttsacks10","jjunezero10","LstockValField_rdKts10","HsVal_rdKts10","HsTotAsset_rdKts10","SumValue_rdKts10","IWC10","Loiske_rev10")
#merge with demographic data
#1995
merge_1 <- merge(data_demo,data_wealth_95,by=c("UIyearXhsh95"),all.x=T)
#1998
merge_1 <- merge(merge_1,data_wealth_98,by=c("UIyearXhsh98"),all.x=T)
#2000
merge_1 <- merge(merge_1,data_wealth_00,by=c("UIyearXhsh00"),all.x=T)
#2002
merge_1 <- merge(merge_1,data_wealth_02,by=c("UIyearXhsh02"),all.x=T)
#2004
merge_1 <- merge(merge_1,data_wealth_04,by=c("UIyearXhsh04"),all.x=T)
#2006
merge_1 <- merge(merge_1,data_wealth_06,by=c("UIyearXhsh06"),all.x=T)
#2010
merge_1 <- merge(merge_1,data_wealth_10,by=c("UIyearXhsh10"),all.x=T)
#women who are in the sampled window
#sample size
#check the number of women who gave birth after the data collection started
table(merge_1$in_sampled_window)
#n=335
#subset sample
sample <- merge_1[merge_1$in_sampled_window==1,]
#whole data versus sample
palette(hcl.colors(2,"Geyser",alpha=0.5))
#only sample
plot(sample$AFB~sample$DOBYR,col=2,pch=16,ylim=c(10,51),xlim=c(1910,2000),xlab="Year of mother's birth",ylab="Age at first reproduction",main="Sample",cex=3)
plot(sample$AFB~sample$DOBYR,col=2,pch=16,xlab="Year of birth",ylab="Age at first reproduction",main="Sample",cex=3)
plot(merge_1$AFB~merge_1$DOBYR,col=as.factor(merge_1$in_sampled_window),pch=16,ylim=c(10,51),xlim=c(1910,2000),xlab="Year of birth",ylab="Age at first reproduction",main="Population",cex=3)
plot(merge_1$AFB~merge_1$DOBYR,col=as.factor(merge_1$in_sampled_window),pch=16,ylim=c(10,51),xlim=c(1910,2000),xlab="Year of birth",ylab="Age at first reproduction",main="Population",cex=3, cex.axis=3)
plot(merge_1$AFB~merge_1$DOBYR,col=as.factor(merge_1$in_sampled_window),pch=16,ylim=c(10,51),xlim=c(1910,2000),xlab="Year of birth",ylab="Age at first reproduction",main="Population",cex=3, cex.lab=3)
plot(merge_1$AFB~merge_1$DOBYR,col=as.factor(merge_1$in_sampled_window),pch=16,ylim=c(10,51),xlim=c(1910,2000),xlab="Year of birth",ylab="Age at first reproduction",cex=3, cex.lab=3)
plot(merge_1$AFB~merge_1$DOBYR,col=as.factor(merge_1$in_sampled_window),pch=16,ylim=c(10,51),xlim=c(1910,2000),xlab="Year of birth",ylab="Age at first reproduction",cex=3)
plot(merge_1$AFB~merge_1$DOBYR,col=as.factor(merge_1$in_sampled_window),pch=16,ylim=c(10,51),xlim=c(1910,2000),xlab="Year of birth",ylab="Age at first reproduction",cex=3, cex.lab=3)
plot(merge_1$AFB~merge_1$DOBYR,col=as.factor(merge_1$in_sampled_window),pch=16,ylim=c(10,51),xlim=c(1910,2000),xlab="Year of birth",ylab="Age at first reproduction",cex=3, cex.lab=1.5)
